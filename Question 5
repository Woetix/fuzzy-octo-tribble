library(dplyr)
sourceCC<-readRDS("Source_Classification_Code.rds")
summary<-readRDS("summarySCC_PM25.rds")
summary<-transform(summary, year= factor(year))
xCoal<-sourceCC[grep("motor",tolower(sourceCC$Short.Name)),]
xCombustion<-sourceCC[grep("vehicle",tolower(sourceCC$Short.Name)),]
xCoalCombustion<-intersect(xCombustion,xCoal)
summary<-merge(summary,xCoalCombustion)
byyear<-group_by(summary,year)
df2<-summarise(byyear,tot=sum(Emissions))
barplot(df2$tot,names.arg=df2$year, col = "grey", main = list("Total PM2.5 Emissions from Coal Combustion-related Sources",font =0.5,cex=0.8) , sub ="USA",xlab="Years", ylab ="Emissions in tonnes"))
## Save to File
dev.copy(png, file="plot4.png", height=480, width=480)
dev.off()

